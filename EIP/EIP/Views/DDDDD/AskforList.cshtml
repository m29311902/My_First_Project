@{
    ViewBag.Title = "AskforList";
    Layout = "~/Views/Shared/_Layout.cshtml";
}






<div class="ui pointing secondary menu">
    <a class="active item" data-tab="first">請假</a>
    <a class="item" data-tab="second" id="加班法規彈出" onclick="加班法規彈出()">加班</a>
    <a class="item" data-tab="third">出差</a>
</div>
<div class="ui active tab segment" data-tab="first">
    <div class="ui top attached tabular menu">
        <a class="active item 請假搜尋消失" data-tab="first/a">請假申請</a>
        <a class="item 請假搜尋" data-tab="first/b" onclick="getAskForList16464()">請假總列表</a>
        <a class="item 請假搜尋消失" data-tab="first/c">請假未審核總表</a>
        <a class="item 請假搜尋消失" id="隱藏審核" data-tab="first/d" onclick="請假已審核()">請假已審核總表</a>
        <div class="d-flex" style="margin-right:0;margin:auto;">
            <div class="ui action input searchvacation" hidden>
                <input type="text" class="searchbox" placeholder="搜尋員工姓名..." name="searchbox">
                <button class="ui searchbtn" onclick="search()">
                    <i class="search icon"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="ui bottom attached active tab segment" data-tab="first/a">
        <div class="head">
            <h2 class="h2共用">請假(新增)</h2>
            <form name="form2" class="form1">
                <div class="d-flex flex-wrap justify-content-center pt-3">
                    <div class="mb-4 col-12 col-md-4">
                        <label>員工編號:</label>
                        <label></label>
                        <input type="text" id="請假EmployeeID" class="w-100" name="EmployeeID" readonly />
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>員工姓名:</label>
                        <label></label>
                        <input type="text" id="請假中文姓名" class="w-100" name="中文姓名" readonly />
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>職稱:</label>
                        <label></label>
                        <input type="text" id="請假jobtitle" class="w-100" name="職稱" readonly />
                    </div>
                </div>
                <div class="d-flex flex-wrap justify-content-center">
                    <div class="mb-4 col-12 col-md-4">
                        <label>信箱:</label>
                        <label></label>
                        <input type="text" id="請假Email" class="w-100" name="信箱" readonly />
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>部門:</label>
                        <label></label>
                        <input type="text" id="請假department" class="w-100" name="部門" readonly />
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>請假班別:</label>
                        <select id="請假班別2" class="w-100" name="請假班別" readonly>
                            <option value="請選擇">請選擇</option>
                            <option value="早班">早班</option>
                            <option value="晚班">晚班</option>
                        </select>
                        @*<input type="text" id="請假班別2" class="w-100" name="請假班別" readonly />*@
                    </div>
                </div>
                <div class="d-flex flex-wrap justify-content-center">
                    <div class="mb-4 col-12 col-md-4">
                        <label>開始日期:</label>
                        <input type="datetime-local" id="請假startday" class="w-100" name="開始日期" readonly>
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>結束日期:</label>
                        <input type="datetime-local" id="請假endday" class="w-100" name="結束日期" readonly>
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>申請日期:</label>
                        <input type="datetime-local" id="請假applicationday" class="w-100" name="申請日期" readonly>
                    </div>
                </div>
                <div class="d-flex flex-wrap justify-content-center">
                    <div class="mb-4 col-12 col-md-4">
                        <label>請假時數:</label>
                        <label></label>
                        <input type="text" id="請假askfortime" class="w-100 請假時數" name="請假時數">
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>代理人:</label>
                        <input type="text" id="請假agent" class="w-100" name="代理人" required>
                    </div>
                    <div class="mb-4 col-12 col-md-4">
                        <label>已用可用:</label>
                        <input type="text" id="請假已用可用" class="w-100" name="已用可用" required />
                    </div>
                </div>
                <div class="d-flex flex-wrap justify-content-between align-items-center">
                    <div class="mb-4 col-12 col-md-4">
                        <label>請假類別:</label>
                        <select id="請假select1" class="w-100" name="假別ID" required>
                            <option value="0">請選擇</option>
                            <option value="1">事假</option>
                            <option value="2">病假</option>
                            <option value="3">生理假</option>
                            <option value="4">喪假</option>
                            <option value="5">婚假</option>
                            <option value="6">公假</option>
                            <option value="7">產假</option>
                            <option value="8">陪產假</option>
                            <option value="9">防疫隔離假</option>
                            <option value="10">特休</option>
                            <option value="11">加班補修</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-4">
                        <input type="file" name="圖片" id="upload" multiple />
                        <input type="reset" class="resetform" hidden />
                    </div>
                    <input type="text" id="審核狀態" class="w-100" name="審核狀態" value="未審核" hidden />
                </div>
                <div class="form-group d-flex justify-content-center">
                    <a class="btn btn-primary" id="button送出" style="width:200px;" onclick="AddEmp()">送出</a>
                    <a class="btn btn-secondary ml-5" id="buttonDemo" style="width:200px;" onclick="Demo()">DEMO</a>
                </div>
            </form>
        </div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="first/b">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head請假總表">
            </thead>
            <tbody id="AskForListTbody請假總表">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page請假"></div>
        </div>
        <div class="append請假refreshBtn"></div>
    </div>

    <div class="ui bottom attached tab segment" data-tab="first/c">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head總表">
            </thead>
            <tbody id="AskForListTbody">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page請假未審核"></div>
        </div>
        <div class="append請假未審核refreshBtn"></div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="first/d">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head總表請假">
            </thead>
            <tbody id="AskForListTbody請假">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page請假通過"></div>
        </div>
        <div class="append請假通過refreshBtn"></div>
    </div>
</div>
@*======================================加班申請=======================================*@
<div class="ui tab segment" data-tab="second">
    <div class="ui top attached tabular menu">
        <a class="item 加班搜尋消失" data-tab="second/a">加班申請</a>
        <a class="item 加班搜尋" data-tab="second/b" onclick="getOverTimeList123()">加班總列表</a>
        <a class="item 加班搜尋消失" data-tab="second/c">加班未審核總表</a>
        <a class="item 加班搜尋消失" id="隱藏加班審核" data-tab="second/d" onclick="加班已審核()">加班已審核總表</a>
        <div class="d-flex" style="margin-right:0;margin:auto;">
            <div class="ui action input searchvacation1" hidden>
                <input type="text" class="searchbox加班" placeholder="搜尋員工姓名..." name="searchbox加班">
                <button class="ui searchbtn" id="加班隱藏鍵" onclick="search加班()">
                    <i class="search icon"></i>
                </button>
            </div>
        </div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="second/a">
        <div class="head">
            <form class="leftbody">
                <h2 class="h2共用">加班單</h2>
                <div class="d-flex justify-content-center flex-wrap">
                    <div class="col-md-6 加班單內容左">
                        <div class="mb-4 員工編號">
                            <label>員工編號:</label><br />
                            <input type="text" class="w-75" id="加班EmployeeID" readonly>
                        </div>
                        <div class="mb-4 中文姓名">
                            <label>中文姓名:</label><br />
                            <input type="text" class="w-75" id="加班中文姓名" readonly>
                        </div>
                        <div class="mb-4 部門">
                            <label>部&emsp;&emsp;門:</label><br />
                            <input type="text" class="w-75 " id="加班department" readonly>
                        </div>
                        <div class="mb-4 test 開始日期">
                            <label>開始日期:</label><br />
                            <input type="datetime-local" id="加班startday" class="w-75" required>
                        </div>
                        <div class="mb-4 test1 結束日期">
                            <label>結束日期:</label><br />
                            <input type="datetime-local" id="加班endday" class="w-75" required>
                        </div>
                    </div>
                    <div class="bodyright col-md-6 加班單內容左">
                        <div class="mb-3">
                            <label>事由說明:</label><br />
                            <textarea id="加班事由說明" class="w-75" rows="8" name="TxtMemo" cols="18" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label>加班類別:</label>
                            <div class="mr-3 加班類別" id="加班ID2" required>
                                <input type="radio" name="加班類別" value="1" />&ensp;延長加班
                                <input type="radio" name="加班類別" value="2" class="ml-3" />&ensp;例假日加班<br />
                                <input type="radio" name="加班類別" value="3" />&ensp;休息日加班
                                <input type="radio" name="加班類別" value="4" />&ensp;國定假日加班
                            </div>
                        </div>
                        <div class="mb-4">
                            <div class="mb-4 加班時數">
                                <label>加班時數:</label><br />
                                <input type="text" class="w-75" id="加班時數2">
                            </div>
                        </div>
                        <input type="text" name="審核狀態" id="加班審核狀態" value="未審核" hidden>
                    </div>
                </div>
                <div class="form-group d-flex justify-content-center">
                    <a class="btn btn-primary 加班送出" style="width:200px;" onclick="AddOverTime()">送出</a>
                    <a class="btn btn-secondary ml-5" id="buttonDemo" style="width:200px;" onclick="加班Demo()">DEMO</a>
                </div>
            </form>
        </div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="second/b">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head加班總表">
            </thead>
            <tbody id="OverTimeListTbody加班總表">
            </tbody>
        </table>
        <div class="d-flex justify-content-center" id="Page加班總表隱藏">
            <div id="Page加班"></div>
        </div>
        <div class="append加班refreshBtn"></div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="second/c">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head加班">
            </thead>
            <tbody id="OverTimeListTbody">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page加班未審核"></div>
        </div>
        <div class="append加班未審核refreshBtn"></div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="second/d">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head已審核">
            </thead>
            <tbody id="OverTimeListTbody加班">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page加班通過"></div>
        </div>
        <div class="append加班通過refreshBtn"></div>
    </div>
</div>
@*======================================出差申請=======================================*@
<div class="ui tab segment" data-tab="third">
    <div class="ui top attached tabular menu">
        <a class="item 出差搜尋消失" data-tab="third/a">出差申請</a>
        <a class="item 出差搜尋" data-tab="third/b" onclick="GetBusinessTripList總表()">出差總列表</a>
        <a class="item 出差搜尋消失" data-tab="third/c">出差未審核總表</a>
        <a class="item 出差搜尋消失" id="隱藏出差審核" data-tab="third/d" onclick="出差已審核()">出差已審核總表</a>
        <div class="d-flex" style="margin-right:0;margin:auto;">
            <div class="ui action input searchvacation" hidden>
                <input type="text" class="searchbox出差" placeholder="搜尋員工姓名..." name="searchbox出差">
                <button class="ui searchbtn searchbtn" onclick="search出差()">
                    <i class="search icon"></i>
                </button>
            </div>
        </div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="third/a">
        <div class="head">
            <div class="ui form">
                <h2 class="h2共用">出差單</h2>
                <div class="three fields">
                    <div class="field">
                        <label>員工編號:</label>
                        <input type="text" id="出差EmployeeID" name="EmployeeID" readonly>
                    </div>
                    <div class="field">
                        <label>申請人:</label>
                        <input type="text" id="出差中文姓名" name="中文姓名" readonly>
                    </div>
                    <div class="field">
                        <label>部&emsp;&emsp;門:</label>
                        <input type="text" id="出差部門" name="部門">
                    </div>
                </div>
                <div class="three fields">
                    <div class="field">
                        <label>出差類型:</label>
                        <select class="ui fluid dropdown" id="出差出差類型" name="出差類型" required>
                            <option value="請選擇">請選擇</option>
                            <option value="國內">國內</option>
                            <option value="國外">國外</option>
                        </select>
                    </div>
                    <div class="field">
                        <label>交通需求:</label>
                        <div class="field">
                            <select class="ui fluid dropdown" id="出差交通需求" name="交通需求" required>
                                <option value="請選擇">請選擇</option>
                                <option value="火車票">火車票</option>
                                <option value="高鐵票">高鐵票</option>
                                <option value="飛機票">飛機票</option>
                                <option value="自行安排">自行安排</option>
                            </select>
                        </div>
                    </div>
                    <div class="field">
                        <label>住宿需求:</label>
                        <select class="ui fluid dropdown" id="出差住宿需求" name="住宿需求" required>
                            <option value="請選擇">請選擇</option>
                            <option value="無">無</option>
                            <option value="國內住宿">國內住宿</option>
                            <option value="國外住宿">國外住宿</option>
                            <option value="自行安排">自行安排</option>
                        </select>
                    </div>
                </div>
                <div class="four fields">
                    <div class="field">
                        <label>開始日期:</label>
                        <input type="datetime-local" id="出差開始日期" name="開始日期" required>
                    </div>
                    <div class="field">
                        <label>結束日期:</label>
                        <input type="datetime-local" id="出差結束日期" name="結束日期" required>
                    </div>
                    <div class="field">
                        <label>預支費用:</label>
                        <input type="text" name="預支費用" id="出差預支費用" required>
                    </div>

                    <div class="field">
                        <label>出差地點:</label>
                        <input type="text" name="出差地點" id="出差出差地點" required>
                    </div>
                </div>
                <div class="field">
                    <label>備註:</label>
                    <textarea id="出差備註" style="resize:none"></textarea>
                </div>
            </div>
            <input type="text" name="審核狀態" id="出差審核狀態" value="未審核" hidden>
            <div class="form-group d-flex justify-content-center mt-3">
                <a class="btn btn-primary" style="width:200px;" onclick="AddBusinessTripAjax()">送出</a>
                <a class="btn btn-secondary ml-5" id="buttonDemo" style="width:200px;" onclick="出差Demo()">DEMO</a>
            </div>
        </div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="third/b">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head出差總表">
            </thead>
            <tbody id="BusinessTripListTbody出差總表">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page出差"></div>
        </div>
        <div class="append出差refreshBtn"></div>
    </div>
    <div class="ui bottom attached tab segment" data-tab="third/c">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head未審核">
            </thead>
            <tbody id="BusinessTripListTbody">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page出差未審核"></div>
        </div>
        <div class="append出差未審核refreshBtn"></div>
    </div>

    <div class="ui bottom attached tab segment" data-tab="third/d">
        <table class="table-hover w-100 table table-striped text-nowrap">
            <thead id="head出差">
            </thead>
            <tbody id="BusinessTripListTbody出差">
            </tbody>
        </table>
        <div class="d-flex justify-content-center">
            <div id="Page出差通過"></div>
        </div>
        <div class="append出差通過refreshBtn"></div>
    </div>
</div>


@*======================================請假彈出=======================================*@

<div class="ui tiny modal centermodal" id="請假彈出">
    <div class="header">Header</div>
    <div class="content">
        @*Start*@
        <div class="d-flex justify-content-center">
            <form>
                <div>
                    <label>員工編號:</label>
                    <label></label>
                    <input type="text" class="w-100" id="EmployeeID" readonly />
                </div>
                <div>
                    <label>員工姓名:</label>
                    <label></label>
                    <input type="text" class="w-100" id="中文姓名" readonly />
                </div>
                <div>
                    <label>職&emsp;&emsp;稱:</label>
                    <label></label>
                    <input type="text" class="w-100" id="jobtitle" readonly />
                </div>
                <div>
                    <label>信&emsp;&emsp;箱:</label>
                    <label></label>
                    <input type="text" class="w-100" id="Email" readonly />
                </div>
                <div>
                    <label>部&emsp;&emsp;門:</label>
                    <label></label>
                    <input type="text" class="w-100" id="department" readonly />
                </div>
                <div>
                    <label>請假班別:</label>
                    <select id="請假班別" class="w-100" readonly>
                        <option value="請選擇">請選擇</option>
                        <option value="早班">早班</option>
                        <option value="晚班">晚班</option>
                    </select>
                    @*<input type="text" class="w-100" id="請假班別" readonly />*@
                </div>
                <div>
                    <label>請假類別:</label>
                    <select class="w-100" id="select1" readonly>
                        <option value="0">請選擇</option>
                        <option value="1">事假</option>
                        <option value="2">病假</option>
                        <option value="3">生理假</option>
                        <option value="4">喪假</option>
                        <option value="5">婚假</option>
                        <option value="6">公假</option>
                        <option value="7">產假</option>
                        <option value="8">陪產假</option>
                        <option value="9">防疫隔離假</option>
                        <option value="10">特休</option>
                        <option value="11">加班補修</option>
                    </select>
                </div>
                <div>
                    <label>開始日期</label>
                    <input type="datetime-local" class="w-100" id="startday" readonly>
                </div>
                <div>
                    <label>結束日期</label>
                    <input type="datetime-local" class="w-100" id="endday" readonly>
                </div>
                <div>
                    <label>申請日期</label>
                    <input type="datetime-local" class="w-100" id="applicationday" readonly>
                </div>
                <div>
                    <label>請假時數</label>
                    <input type="text" class="w-100" id="askfortime" readonly>
                </div>
                <div>
                    <label>代理人</label>
                    <input class="w-100" type="text" id="agent" readonly>
                </div>
                <div>
                    <label>審核狀態</label><br />
                    <select class="w-100" id="approvalStatus" readonly>
                        <option value="未審核">未審核</option>
                        <option value="通過">通過</option>
                        <option value="未通過">未通過</option>
                    </select>
                </div>
                <div class="mt-3">
                    <img src="" class="showPic" style="width:400px;" />
                </div>
            </form>
        </div>
    </div> @*End*@
    <div class="actions d-flex justify-content-center">
        <div class="ui approve button" id="按鈕消失" onclick="Update請假()">確認修改</div>
        <div class="ui cancel button">取消</div>
    </div>
</div>


@*======================================加班彈出=======================================*@

<div class="ui tiny modal centermodal" id="加班彈出">
    <div class="header">加班單(修改)</div>
    <div class="content">
        @*Start*@
        <form>
            <div>
                <div>
                    <label>員工編號:</label>
                    <input type="text" class="w-100" id="加班總表EmployeeID" readonly>
                </div>
                <div>
                    <label>中文姓名:</label>
                    <input type="text" class="w-100" id="加班總表中文姓名" readonly>
                </div>
                <div>
                    <label>部&emsp;&emsp;門:</label>
                    <input type="text" class="w-100" id="加班總表department" readonly>
                </div>
            </div>
            <div>
                <div>
                    <label>開始日期:</label>
                    <input type="datetime-local" id="加班總表startday" class="w-100" readonly>
                </div>
                <div>
                    <label>結束日期:</label>
                    <input type="datetime-local" id="加班總表endday" class="w-100" readonly>
                </div>
                <div>
                    <label>加班時數:</label>
                    <input type="text" class="w-100" id="加班總表加班時數" readonly>
                </div>
            </div>
            <div>
                <div>
                    <label>加班類別:</label>
                    <div class="mr-3" id="加班總表加班ID">
                        <input type="radio" name="加班類別" value="1" readonly />&ensp;延長加班
                        <input type="radio" name="加班類別" value="2" readonly />&ensp;例假日加班<br />
                        <input type="radio" name="加班類別" value="3" readonly />&ensp;休息日加班
                        <input type="radio" name="加班類別" value="4" readonly />&ensp;國定假日加班
                    </div>
                </div>
                <div>
                    <label>事由說明:</label><br />
                    <textarea id="加班總表事由說明" style="resize:none" class="w-100" readonly></textarea>
                </div>
                <div>
                    <label>審核狀態</label><br />
                    <select id="加班approvalStatus" readonly>
                        <option value="未審核">未審核</option>
                        <option value="通過">通過</option>
                        <option value="未通過">未通過</option>
                    </select>
                </div>
            </div>
            <div class="actions mt-3 d-flex justify-content-center">
                <div class="ui approve button" id="加班按鈕消失" onclick="Update()">確認修改</div>
                <div class="ui cancel button">取消</div>
            </div>
        </form>
    </div> @*End*@
</div>




@*==========================================出差彈出==================================================*@
<div class="ui tiny modal centermodal" id="出差彈出">
    <div class="header">出差</div>
    <div class="content">
        @*Start*@
        <form>
            <div>
                <div class="mb-4 員工編號">
                    <label>員工編號:</label><br />
                    <input type="text" class="w-100" id="出差總表EmployeeID" readonly>
                </div>
                <div class="mb-4 申請人">
                    <label>申請人:</label><br />
                    <input type="text" class="w-100" id="出差總表中文姓名" readonly>
                </div>
                <div class="mb-4 部門">
                    <label>部&emsp;&emsp;門:</label><br />
                    <input type="text" class="w-100 " id="出差總表部門" readonly>
                </div>
                <div class="mb-4">
                    <label>出差類型:</label><br />
                    <select id="出差總表出差類型" class="w-100" readonly>
                        <option value="請選擇">請選擇</option>
                        <option value="國內">國內</option>
                        <option value="國外">國外</option>
                    </select>
                </div>
            </div>
            <div>
                <div class="mb-4 出差地點">
                    <label>出差地點:</label><br />
                    <input type="text" class="w-100" id="出差總表出差地點" readonly>
                </div>
                <div class="mb-4 test 開始日期">
                    <label>開始日期:</label><br />
                    <input type="datetime-local" id="出差總表開始日期" class="w-100" readonly>
                </div>
                <div class="mb-4 test1 結束日期">
                    <label>結束日期:</label><br />
                    <input type="datetime-local" id="出差總表結束日期" class="w-100" readonly>
                </div>
            </div>
            <div>
                <div class="mb-4">
                    <label>交通需求:</label><br />
                    <select id="出差總表交通需求" class="w-100" readonly>
                        <option value="請選擇">請選擇</option>
                        <option value="火車票">火車票</option>
                        <option value="高鐵票">高鐵票</option>
                        <option value="飛機票">飛機票</option>
                        <option value="自行安排">自行安排</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label>住宿需求:</label><br />
                    <select id="出差總表住宿需求" class="w-100" readonly>
                        <option value="請選擇">請選擇</option>
                        <option value="無">無</option>
                        <option value="國內住宿">國內住宿</option>
                        <option value="國外住宿">國外住宿</option>
                        <option value="自行安排">自行安排</option>
                    </select>
                </div>
                <div class="mb-4 預支費用">
                    <label>預支費用:</label><br />
                    <input type="number" class="w-100" id="出差總表預支費用" min="1000" readonly>
                </div>
                <div class="mb-3">
                    <label>備註:</label><br />
                    <textarea id="出差總表備註" class="w-100" readonly></textarea>
                </div>
                <div>
                    <label>審核狀態</label><br />
                    <select id="出差approvalStatus" class="w-100">
                        <option value="未審核">未審核</option>
                        <option value="通過">通過</option>
                        <option value="未通過">未通過</option>
                    </select>
                </div>
            </div>
            <div class="actions my-4  d-flex justify-content-center">
                <div class="ui approve button" id="出差按鈕消失" onclick="UpdateBusiness()">送出</div>
                <div class="ui cancel button">取消</div>
            </div>
        </form>
    </div>
</div> @*End*@

@*==========================================加班法規彈出==================================================*@

<div class="ui modal centermodal" id="加班法規彈出modal">
    <div class="header">相關規定</div>
    <div class="scrolling content">
        @*Start*@
        <div class="規定 ml-3">
            <p class="px-3 加班法規內文">
                第 30 條<br />
                勞工正常工作時間，每日不得超過八小時，每週不得超過四十小時。<br />
                前項正常工作時間，雇主經工會同意，如事業單位無工會者，經勞資會議
                同意後，得將其二週內二日之正常工作時數，分配於其他工作日。其分配
                於其他工作日之時數，每日不得超過二小時。但每週工作總時數不得超過
                四十八小時。<br />
                第一項正常工作時間，雇主經工會同意，如事業單位無工會者，經勞資會
                議同意後，得將八週內之正常工作時數加以分配。但每日正常工作時間不
                得超過八小時，每週工作總時數不得超過四十八小時。<br />
                前二項規定，僅適用於經中央主管機關指定之行業。<br />
                雇主應置備勞工出勤紀錄，並保存五年。<br />
                前項出勤紀錄，應逐日記載勞工出勤情形至分鐘為止。勞工向雇主申請其
                出勤紀錄副本或影本時，雇主不得拒絕。<br />
                雇主不得以第一項正常工作時間之修正，作為減少勞工工資之事由。<br />
                第一項至第三項及第三十條之一之正常工作時間，雇主得視勞工照顧家庭
                成員需要，允許勞工於不變更每日正常工作時數下，在一小時範圍內，彈
                性調整工作開始及終止之時間。<br />
                第 30-1 條<br />
                中央主管機關指定之行業，雇主經工會同意，如事業單位無工會者，經勞
                資會議同意後，其工作時間得依下列原則變更：<br />
                一、四週內正常工作時數分配於其他工作日之時數，每日不得超過二小時
                ，不受前條第二項至第四項規定之限制。<br />
                二、當日正常工作時間達十小時者，其延長之工作時間不得超過二小時。<br />
                三、女性勞工，除妊娠或哺乳期間者外，於夜間工作，不受第四十九條第
                一項之限制。但雇主應提供必要之安全衛生設施。<br />
                依中華民國八十五年十二月二十七日修正施行前第三條規定適用本法之行
                業，除第一項第一款之農、林、漁、牧業外，均不適用前項規定。<br />
                第 31 條<br />
                在坑道或隧道內工作之勞工，以入坑口時起至出坑口時止為工作時間。<br />
                第 32 條<br />
                雇主有使勞工在正常工作時間以外工作之必要者，雇主經工會同意，如事
                業單位無工會者，經勞資會議同意後，得將工作時間延長之。<br />
                前項雇主延長勞工之工作時間連同正常工作時間，一日不得超過十二小時
                ；延長之工作時間，一個月不得超過四十六小時，但雇主經工會同意，如
                事業單位無工會者，經勞資會議同意後，延長之工作時間，一個月不得超
                過五十四小時，每三個月不得超過一百三十八小時。<br />
                雇主僱用勞工人數在三十人以上，依前項但書規定延長勞工工作時間者，
                應報當地主管機關備查。<br />
                因天災、事變或突發事件，雇主有使勞工在正常工作時間以外工作之必要
                者，得將工作時間延長之。但應於延長開始後二十四小時內通知工會；無
                工會組織者，應報當地主管機關備查。延長之工作時間，雇主應於事後補
                給勞工以適當之休息。<br />
                在坑內工作之勞工，其工作時間不得延長。但以監視為主之工作，或有前
                項所定之情形者，不在此限。<br />
                第 32-1 條<br />
                雇主依第三十二條第一項及第二項規定使勞工延長工作時間，或使勞工於
                第三十六條所定休息日工作後，依勞工意願選擇補休並經雇主同意者，應
                依勞工工作之時數計算補休時數。<br />
                前項之補休，其補休期限由勞雇雙方協商；補休期限屆期或契約終止未補
                休之時數，應依延長工作時間或休息日工作當日之工資計算標準發給工資
                ；未發給工資者，依違反第二十四條規定論處。<br />
                第 33 條<br />
                第三條所列事業，除製造業及礦業外，因公眾之生活便利或其他特殊原因
                ，有調整第三十條、第三十二條所定之正常工作時間及延長工作時間之必
                要者，得由當地主管機關會商目的事業主管機關及工會，就必要之限度內
                以命令調整之。<br />
                第 34 條<br />
                勞工工作採輪班制者，其工作班次，每週更換一次。但經勞工同意者不在
                此限。<br />
                依前項更換班次時，至少應有連續十一小時之休息時間。但因工作特性或
                特殊原因，經中央目的事業主管機關商請中央主管機關公告者，得變更休
                息時間不少於連續八小時。<br />
                雇主依前項但書規定變更休息時間者，應經工會同意，如事業單位無工會
                者，經勞資會議同意後，始得為之。雇主僱用勞工人數在三十人以上者，
                應報當地主管機關備查。<br />
                第 35 條<br />
                勞工繼續工作四小時，至少應有三十分鐘之休息。但實行輪班制或其工作
                有連續性或緊急性者，雇主得在工作時間內，另行調配其休息時間。<br />
                第 36 條<br />
                勞工每七日中應有二日之休息，其中一日為例假，一日為休息日。<br />
                雇主有下列情形之一，不受前項規定之限制：<br />
                一、依第三十條第二項規定變更正常工作時間者，勞工每七日中至少應有
                一日之例假，每二週內之例假及休息日至少應有四日。<br />
                二、依第三十條第三項規定變更正常工作時間者，勞工每七日中至少應有
                一日之例假，每八週內之例假及休息日至少應有十六日。<br />
                三、依第三十條之一規定變更正常工作時間者，勞工每二週內至少應有二
                日之例假，每四週內之例假及休息日至少應有八日。<br />
                雇主使勞工於休息日工作之時間，計入第三十二條第二項所定延長工作時
                間總數。但因天災、事變或突發事件，雇主有使勞工於休息日工作之必要
                者，其工作時數不受第三十二條第二項規定之限制。<br />
                經中央目的事業主管機關同意，且經中央主管機關指定之行業，雇主得將
                第一項、第二項第一款及第二款所定之例假，於每七日之週期內調整之。
                前項所定例假之調整，應經工會同意，如事業單位無工會者，經勞資會議
                同意後，始得為之。雇主僱用勞工人數在三十人以上者，應報當地主管機
                關備查。<br />
                第 37 條<br />
                內政部所定應放假之紀念日、節日、勞動節及其他中央主管機關指定應放
                假日，均應休假。<br />
                中華民國一百零五年十二月六日修正之前項規定，自一百零六年一月一日
                施行。<br />
                第 38 條<br />
                勞工在同一雇主或事業單位，繼續工作滿一定期間者，應依下列規定給予
                特別休假：<br />
                一、六個月以上一年未滿者，三日。<br />
                二、一年以上二年未滿者，七日。<br />
                三、二年以上三年未滿者，十日。<br />
                四、三年以上五年未滿者，每年十四日。<br />
                五、五年以上十年未滿者，每年十五日。<br />
                六、十年以上者，每一年加給一日，加至三十日為止。<br />
                前項之特別休假期日，由勞工排定之。但雇主基於企業經營上之急迫需求
                或勞工因個人因素，得與他方協商調整。<br />
                雇主應於勞工符合第一項所定之特別休假條件時，告知勞工依前二項規定
                排定特別休假。<br />
                勞工之特別休假，因年度終結或契約終止而未休之日數，雇主應發給工資
                。但年度終結未休之日數，經勞雇雙方協商遞延至次一年度實施者，於次
                一年度終結或契約終止仍未休之日數，雇主應發給工資。<br />
                雇主應將勞工每年特別休假之期日及未休之日數所發給之工資數額，記載
                於第二十三條所定之勞工工資清冊，並每年定期將其內容以書面通知勞工
                。<br />
                勞工依本條主張權利時，雇主如認為其權利不存在，應負舉證責任。<br />
                第 39 條<br />
                第三十六條所定之例假、休息日、第三十七條所定之休假及第三十八條所
                定之特別休假，工資應由雇主照給。雇主經徵得勞工同意於休假日工作者
                ，工資應加倍發給。因季節性關係有趕工必要，經勞工或工會同意照常工
                作者，亦同。<br />
                第 40 條<br />
                因天災、事變或突發事件，雇主認有繼續工作之必要時，得停止第三十六
                條至第三十八條所定勞工之假期。但停止假期之工資，應加倍發給，並應
                於事後補假休息。<br />
                前項停止勞工假期，應於事後二十四小時內，詳述理由，報請當地主管機
                關核備。<br />
                第 41 條<br />
                公用事業之勞工，當地主管機關認有必要時，得停止第三十八條所定之特
                別休假。假期內之工資應由雇主加倍發給。<br />
                第 42 條<br />
                勞工因健康或其他正當理由，不能接受正常工作時間以外之工作者，雇主
                不得強制其工作。<br />
                第 43 條<br />
                勞工因婚、喪、疾病或其他正當事由得請假；請假應給之假期及事假以外
                期間內工資給付之最低標準，由中央主管機關定之。<br />
            </p>
        </div> @*End*@
    </div>
    <div class="form-group d-flex justify-content-center actions">
        <div class="ui cancel button">我同意</div>
    </div>
</div>

@section script{
    <script>

        $('.menu .item').tab();




        //$("#隱藏審核").click(function () {
        //    $('#approvalStatus').attr("disabled", true)
        //});


        function modelshow() {
            $('.tiny#請假彈出').modal('toggle');
        }
        $("#請假EmployeeID").val(`${document.cookie.split('id=')[1].split('&')[0]}`);
        $("#請假中文姓名").val(`${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}`);
        $("#請假jobtitle").val(`${decodeURI(document.cookie.split('Auth=')[1].split('&')[0])}`);

        //==================================請假部分=========================================================================================

        let start;
        let end;

        //=============================新增=======================================


        $("#請假endday, #請假startday").blur(function () {
            if ($("#請假startday").val() != '' && $("#請假endday").val() != '') {
                start = new Date($("#請假startday").val());
                end = new Date($("#請假endday").val());
                var offset = new Date($("#請假endday").val()).getTime() - new Date($("#請假startday").val()).getTime();
                var swag = Math.floor(Math.abs(offset / 1000 / 60 / 60 / 24 - 1));
                console.log(swag);
                let x = Math.floor(swag);
                let 開始小時數 = 17 - start.getHours();
                let 結束小時數 = end.getHours() - 9;
                if (x + 1 < 0) {
                    window.alert("請輸入正確日期");
                }
                else if (start.getDate() === end.getDate()) {
                    $(".請假時數").val(`${end.getHours() - start.getHours()} `)
                }
                else {
                    $(".請假時數").val(`${開始小時數 + swag * 9 + 結束小時數} `)
                }
            }
        });




        function AddEmp() {
            //console.log($(document.form2).find('[name]')[0].value);
            //console.log($("#upload").get(0).files[0].name);
            var formData = new FormData(document.form2);
            console.log(document.form2);
            console.log(formData);
            console.log($("#請假EmployeeID").val());
            console.log($("#請假班別2").val());
            formData.append('upPhoto', $("#upload").get(0).files[0]);
            $.ajax({
                url: "/DDDDD/AskForAjax1",
                type: "POST",
                contentType: false,
                processData: false,
                data: formData,
                success: function (result) {
                    if (result == "ok") {
                        setTimeout(function () {
                            //window.location.href = "/DDDDD/AskforList";
                            $("[data-tab='first/b']").not(".tab").click();
                            ReFresh();
                            ReFresh請假總表();
                            ReFresh請假未審核總表();
                            ReFresh請假通過總表();
                        }, 1000);
                        swal("成功", "新增成功", "success");
                        var 權限陣列 = [];
                        if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "主管" || decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "人事" || decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "員工") {
                            權限陣列.push('總經理');
                            權限陣列.push('主管');
                        }
                        $.connection.hub.start()
                            .done(function () {
                                bell.server.sendGroup(`${1}`, `${decodeURI(document.cookie.split('Auth=')[1].split('&')[0])}`, `有新的請假申請,請前往審核！`, 權限陣列);   //傳值到hub
                            });
                        $(".resetform").click();
                        $("#請假EmployeeID").val(`${document.cookie.split('id=')[1].split('&')[0]}`);
                        $("#請假中文姓名").val(`${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}`);
                        $("#請假jobtitle").val(`${decodeURI(document.cookie.split('Auth=')[1].split('&')[0])}`);
                    }
                }
            })
        }


        function Demo() {
            $("#請假EmployeeID").val(`${document.cookie.split('id=')[1].split('&')[0]}`),
                $("#請假中文姓名").val(`${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}`),
                $("#請假jobtitle").val(`${decodeURI(document.cookie.split('Auth=')[1].split('&')[0])}`),
                $("#請假Email").val("brettHo@gmail.com"),
                $("#請假department").val("資訊部"),
                $("#請假班別2").val('早班'),
                $("#請假startday").val("2021-04-14T09:00:00"),
                $("#請假endday").val("2021-04-14T17:00:00"),
                $("#請假applicationday").val("2021-04-14T09:00:00"),
                $("#請假agent").val("莊若凡"),
                $("#請假askfortime").val("8"),
                $("#審核狀態").val("未審核"),
                $("#請假select1").val(1),
                $("#請假已用可用").val("10")
        };


        //======================================= 總表顯示 =======================================
        $(".請假搜尋").click(function () {
            $(".searchvacation").attr("hidden", false);
        });
        $(".請假搜尋消失").click(function () {
            $(".searchvacation").attr("hidden", true);
        });




        $(function () {
            getAskForList();
        })

        //function search11() {
        //    switch ($(".active").attr("data-tab")) {
        //        case "first":
        //            search()
        //            break;
        //        case "second":
        //            search加班()
        //            break;
        //        case "third":
        //            search出差()
        //            break;
        //    }
        //}



        function search() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/SearchAjax請假",
                    data: { 'name': $(".searchbox").val() },
                    success: function (memberlist) {
                        if (memberlist == 0 || $(".searchbox").val() == "") {
                            swal("查無此資料", "請重新輸入", "error");
                            $(".searchbox").val('');
                        } else {
                            $("#AskForListTbody請假總表").empty();


                            $("#head請假總表").html(
                                `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                            );
                            $(memberlist).each(function (index, item) {
                                var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                                var testtime1 = new Date(testtime);
                                var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                                var testtime2 = new Date(結束日期);
                                var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                                var testtime3 = new Date(申請日期);

                                if (testtime3.getHours() < 10) {
                                    h3 = "0" + testtime3.getHours();
                                } else {
                                    h3 = testtime3.getHours();
                                }
                                if (testtime3.getMinutes() < 10) {
                                    var a3 = "0" + testtime3.getMinutes()
                                } else {
                                    a3 = testtime3.getMinutes();
                                }
                                $("#AskForListTbody請假總表").append(
                                    `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                                );
                                $('.append請假refreshBtn').html(`<a class="btn btn-outline-link button" onclick="ReFresh請假總表()"><span>返回</span></a>`);
                            })
                        }
                        $(".searchbox").val('');
                    },
                });
                $('#Page請假').attr('hidden', true);
            }
            else {
                $.ajax({
                    url: "/DDDDD/SearchAjax請假",
                    data: { 'name': $(".searchbox").val() },
                    success: function (memberlist) {
                        console.log();
                        if (memberlist == 0 || $(".searchbox").val() == "") {
                            swal("查無此資料", "請重新輸入", "error");
                            $(".searchbox").val('');
                        } else {
                            $("#AskForListTbody請假總表").empty();
                            $("#head請假總表").html(
                                `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                            );
                            $(memberlist).each(function (index, item) {
                                var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                                var testtime1 = new Date(testtime);
                                var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                                var testtime2 = new Date(結束日期);
                                var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                                var testtime3 = new Date(申請日期);

                                if (testtime3.getHours() < 10) {
                                    h3 = "0" + testtime3.getHours();
                                } else {
                                    h3 = testtime3.getHours();
                                }
                                if (testtime3.getMinutes() < 10) {
                                    var a3 = "0" + testtime3.getMinutes()
                                } else {
                                    a3 = testtime3.getMinutes();
                                }
                                $("#AskForListTbody請假總表").append(
                                    `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                                );
                                $('.append請假refreshBtn').html(`<a class="btn btn-outline-link button" onclick="ReFresh請假總表()"><span>返回</span></a>`);

                            })
                        }
                        $(".searchbox").val('');

                    },
                });
            }
            $('#Page請假').attr('hidden', true);
        };



        function getAskForList16464() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/AskForList1",
                    type: "GET",
                    success: function (memberlist) {
                        $("#AskForListTbody請假總表").empty();
                        $("#head請假總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        );
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }
                            $("#AskForListTbody請假總表").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            );
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/AskForList1",
                    type: "GET",
                    success: function (memberlist) {
                        $("#AskForListTbody請假總表").empty();
                        $("#head請假總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        );
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }
                            $("#AskForListTbody請假總表").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            );
                        })

                    },
                });
            }
        };



        function getAskForList() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/AskforListAjax",
                    type: "GET",
                    success: function (memberlist) {
                        $("#head總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        );
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }
                            $("#AskForListTbody").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            );
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/AskforListAjax",
                    type: "GET",
                    success: function (memberlist) {
                        $("#head總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        );
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }
                            $("#AskForListTbody").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            );
                        })

                    },
                });
            }
        };


        function 請假已審核() {
            console.log("123456");
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/請假已審核Ajax",
                    type: "GET",
                    success: function (memberlist) {
                        $("#head總表請假").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        );
                        $("#AskForListTbody請假").empty();
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }
                            $("#AskForListTbody請假").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            );
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/請假已審核Ajax",
                    type: "GET",
                    success: function (memberlist) {
                        $("#head總表請假").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        );
                        $("#AskForListTbody請假").empty();
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }
                            $("#AskForListTbody請假").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            );
                        })

                    },
                });
            }
        };
        //======================================= 修改 =======================================

        let getID;

        function Update請假() {
            if (true) {
                $.ajax({
                    url: "/DDDDD/UpdateDataAjax",
                    type: "POST",
                    data: {
                        "申請表編號": getID,
                        "EmployeeID": $("#EmployeeID").val(),
                        "中文姓名": $("#中文姓名").val(),
                        "職稱": $("#jobtitle").val(),
                        "信箱": $("#Email").val(),
                        "部門": $("#department").val(),
                        "請假班別": $("#請假班別").val(),
                        "假別ID": $("#select1").val(),
                        "開始日期": $("#startday").val(),
                        "結束日期": $("#endday").val(),
                        "申請日期": $("#applicationday").val(),
                        "請假時數": $("#askfortime").val(),
                        "代理人": $("#agent").val(),
                        "審核狀態": $("#approvalStatus").val(),
                        "圖片": $(".showPic").attr("src"),
                    },
                    success: function (result) {
                        if (result != 0) {
                            $('#請假彈出').modal('toggle');
                            swal("成功", "修改成功", "success");
                            ReFresh();
                            ReFresh請假總表();
                            ReFresh請假未審核總表();
                            ReFresh請假通過總表();
                            //$('#按鈕消失').attr('hidden', true);
                        }
                    }
                })
            }
        }

        function UpdateGetData請假() {
            console.log($("#隱藏審核").hasClass("active"));
            if ($("#隱藏審核").hasClass("active")) {
                $('#approvalStatus').attr("disabled", true),
                    $('#按鈕消失').attr("hidden", true)
            }
            else {
                $('#approvalStatus').attr("disabled", false),
                    $('#按鈕消失').attr("hidden", false)
            }
            console.log($(event.currentTarget));
            getID = $(event.currentTarget).data("id");
            $.ajax({
                url: "/DDDDD/GetUpdateData",
                type: "GET",
                data: { "id": $(event.currentTarget).data("id") },
                success: function (getdata) {

                    console.log(getdata.圖片);
                    console.log(getdata);
                    var testtime = parseInt(getdata.開始日期.replace(/\D/igm, ""));
                    var testtime1 = new Date(testtime);
                    var 結束日期 = parseInt(getdata.結束日期.replace(/\D/igm, ""));
                    var testtime2 = new Date(結束日期);
                    var 申請日期 = parseInt(getdata.申請日期.replace(/\D/igm, ""));
                    var testtime3 = new Date(申請日期);
                    console.log(testtime1);
                    if ((testtime1.getMonth() + 1) < 10) //月
                    {
                        var a = "0" + (testtime1.getMonth() + 1);  //why var
                    }
                    else {
                        a = (testtime1.getMonth() + 1);
                    }
                    if ((testtime2.getMonth() + 1) < 10) {
                        var gg2 = "0" + (testtime2.getMonth() + 1);
                    }
                    else {
                        gg2 = (testtime2.getMonth() + 1);
                    }
                    if ((testtime3.getMonth() + 1) < 10) {
                        var kk3 = "0" + (testtime3.getMonth() + 1);
                    }
                    else {
                        kk3 = (testtime3.getMonth() + 1);
                    }
                    if (testtime1.getDate() < 10) //日
                    {
                        var rr1 = "0" + (testtime1.getDate());
                    }
                    else {
                        rr1 = testtime1.getDate();
                    }
                    if (testtime2.getDate() < 10) {
                        var aa2 = "0" + (testtime2.getDate());
                    }
                    else {
                        aa2 = testtime2.getDate();
                    }
                    if (testtime3.getDate() < 10) {
                        var bb3 = "0" + (testtime3.getDate());
                    }
                    else {
                        bb3 = testtime3.getDate();
                    }
                    if (testtime1.getHours() < 10) //時
                    {
                        var cc1 = "0" + testtime1.getHours();
                    }
                    else {
                        cc1 = testtime1.getHours();
                    }
                    if (testtime2.getHours() < 10) {
                        var dd2 = "0" + testtime2.getHours();
                    }
                    else {
                        dd2 = testtime2.getHours();
                    }
                    if (testtime3.getHours() < 10) {
                        var ee3 = "0" + (testtime3.getHours());
                    }
                    else {
                        ee3 = testtime3.getHours();
                    }
                    if (testtime1.getMinutes() < 10)  //分
                    {
                        var ff1 = "0" + testtime1.getMinutes();
                    }
                    else {
                        ff1 = testtime1.getMinutes();
                    }
                    if (testtime1.getMinutes() < 10) {
                        var mm2 = "0" + testtime1.getMinutes();
                    }
                    else {
                        mm2 = testtime1.getMinutes();
                    }
                    if (testtime1.getMinutes() < 10) {
                        var ll3 = "0" + testtime1.getMinutes();
                    }
                    else {
                        ll3 = testtime1.getMinutes();
                    }
                    $("#申請表編號").val(getdata.申請表編號);
                    $("#EmployeeID").val(getdata.EmployeeID);
                    $("#中文姓名").val(getdata.中文姓名);
                    $("#jobtitle").val(getdata.職稱);
                    $("#Email").val(getdata.信箱);
                    $("#department").val(getdata.部門);
                    $("#請假班別").val(getdata.請假班別);
                    $("#select1").val(getdata.假別ID);
                    $("#startday").val(testtime1.getFullYear() + "-" + a + "-" + rr1
                        + "T" + cc1 + ":" + ff1 + ":00");
                    $("#endday").val(testtime2.getFullYear() + "-" + gg2 + "-" + aa2
                        + "T" + dd2 + ":" + mm2 + ":00");
                    $("#applicationday").val(testtime3.getFullYear() + "-" + kk3 + "-" + bb3
                        + "T" + ee3 + ":" + ll3 + ":00");
                    $("#askfortime").val(getdata.請假時數);
                    $("#agent").val(getdata.代理人);
                    $("#approvalStatus").val(getdata.審核狀態);
                    $(".showPic").attr("src", getdata.圖片);

                }
            })
        }
        //======================================= 刪除 =======================================
        function Fdelete() {
            if (true) {
                $.ajax({
                    url: "/DDDDD/DeleteData",
                    data: { "id": $(event.currentTarget).data("id") },
                    success: function (result) {
                        swal({
                            title: "刪除?",
                            text: "確定要刪除嗎?",
                            icon: 'warning',
                            buttons: true,
                            dangerMode: true,
                        }).then((confirm) => {
                            if (confirm) {
                                swal('刪除', '刪除成功！...', 'success');
                                ReFresh();
                                ReFresh請假總表();
                                ReFresh請假未審核總表();
                                ReFresh請假通過總表();
                            } else {
                                swal('刪除', '刪除失敗!...', 'error');
                            }
                        })

                    }
                })
            }
        }

        //======================================= 刷新 =======================================
        ReFresh();
        ReFresh請假總表();
        ReFresh請假未審核總表();
        ReFresh請假通過總表();

        function ReFresh() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/AskForListAjax",
                    type: "GET",
                    success: function (memberlist) {
                        $("#head總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let a = " ";
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            a += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td></tr>`
                            $("#AskForListTbody").html(a);
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/AskForListAjax",
                    type: "GET",
                    success: function (memberlist) {
                        $("#head總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        let a = " ";
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            a += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td></tr>`
                            $("#AskForListTbody").html(a);
                        })
                    },
                });
            }
        };





        function ReFresh請假總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $('#Page請假').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/AskForList1",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (memberlist) {
                        $(".append請假refreshBtn").empty();
                        $("#head請假總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let h = " ";
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            h += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td></tr>`
                            $("#AskForListTbody請假總表").html(h);
                        })
                    }

                })
                $('#Page請假').attr('hidden', false);
            }
            else {
                $('#Page請假').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/AskForList1",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (memberlist) {
                        $(".append請假refreshBtn").empty();
                        $("#head請假總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        let h = " ";
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            h += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td></tr>`
                            $("#AskForListTbody請假總表").html(h);
                        })
                    }
                })

            }
            $('#Page請假').attr('hidden', false);
        }







        function ReFresh請假未審核總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $('#Page請假未審核').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/請假未審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (memberlist1) {
                        $(".append請假未審核refreshBtn").empty();
                        $("#head請假").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let h = " ";
                        $(memberlist1).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            h += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td></tr>`
                            $("#AskForListTbody").html(h);
                        })
                    }

                })
            }
            else {
                $('#Page請假未審核').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/請假未審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (memberlist1) {
                        $(".append請假未審核refreshBtn").empty();
                        $("#head總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        let h = " ";
                        $(memberlist1).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            h += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td></tr>`
                            $("#AskForListTbody").html(h);
                        })
                    }
                })

            }
        }









        function ReFresh請假通過總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $('#Page請假通過').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/請假已審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (memberlist2) {
                        $(".append請假通過refreshBtn").empty();
                        $("#head總表請假").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let h = " ";
                        $(memberlist2).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            h += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.申請表編號}" data-target="#請假彈出" onclick="UpdateGetData請假(),modelshow()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Fdelete()" data-id="${item.申請表編號}"><span>刪除</span></a></td></tr>`
                            $("#AskForListTbody請假").html(h);
                        })
                    }

                })
            }
            else {
                $('#Page請假通過').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/請假已審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (memberlist2) {
                        $(".append請假通過refreshBtn").empty();
                        $("#head總表請假").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>職稱</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>請假班別</th>
                                                                                                                <th>假別</th>
                                                                                                                <th>申請日期</th>
                                                                                                                <th>請假時數</th>
                                                                                                                <th>代理人</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        let h = " ";
                        $(memberlist2).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            var 申請日期 = parseInt(item.申請日期.replace(/\D/igm, ""));
                            var testtime3 = new Date(申請日期);

                            if (testtime3.getHours() < 10) {
                                h3 = "0" + testtime3.getHours();
                            } else {
                                h3 = testtime3.getHours();
                            }
                            if (testtime3.getMinutes() < 10) {
                                var a3 = "0" + testtime3.getMinutes()
                            } else {
                                a3 = testtime3.getMinutes();
                            }


                            h += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.職稱}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${item.請假班別}</td>
                                                                                                                    <td>${item.假別1}</td>
                                                                                                                    <td>${testtime3.getFullYear() + "/" + (testtime3.getMonth() + 1) + "/" + testtime3.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.請假時數}</td>
                                                                                                                    <td>${item.代理人}</td>
                                                                                                                    <td>${item.審核狀態}</td></tr>`
                            $("#AskForListTbody請假").html(h);
                        })
                    }
                })

            }
        }
        //==================================================加班部分===========================================================
        function modelshow加班() {
            $('.tiny#加班彈出').modal('toggle');
        }

        function 加班法規彈出() {
            $('#加班法規彈出modal').modal('toggle');
        }


        $("#加班EmployeeID").val(`${document.cookie.split('id=')[1].split('&')[0]}`);
        $("#加班中文姓名").val(`${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}`);
        //=============================================新增=====================================================
        function AddOverTime() {
            console.log(123);
            console.log($("#加班ID2").children(":checked").val());
            $.ajax({
                url: "/DDDDD/OverTimeAjax",
                type: "POST",
                data: {
                    "EmployeeID": $("#加班EmployeeID").val(),
                    "中文姓名": $("#加班中文姓名").val(),
                    "部門": $("#加班department").val(),
                    "開始日期": $("#加班startday").val(),
                    "結束日期": $("#加班endday").val(),
                    "請假時數": $("#加班askfortime").val(),
                    "加班時數": $("#加班時數2").val(),
                    "加班ID": $("#加班ID2").children(":checked").val(),
                    "事由說明": $("#加班事由說明").val(),
                    "審核狀態": $("#加班審核狀態").val(),
                },
                success: function (result) {
                    var 權限陣列 = [];
                    if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "主管" || decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "人事" || decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "員工") {
                        權限陣列.push('總經理');
                        權限陣列.push('主管');
                    }
                    $.connection.hub.start()
                        .done(function () {
                            bell.server.sendGroup(`${1}`, `${decodeURI(document.cookie.split('Auth=')[1].split('&')[0])}`, `有新的加班申請,請前往審核！`, 權限陣列);   //傳值到hub
                        });
                    if (result != null) {
                        setTimeout(function () {
                            //window.location.href = "/DDDDD/OverTimeList";
                            $("[data-tab='second/b']").not(".tab").click();
                        }, 1000);
                        swal("成功", "新增成功", "success");
                        ReFresh加班();
                        ReFresh加班總表();
                        ReFresh加班未審核總表();
                        ReFresh加班通過總表();
                        加班清空();
                        test清空radio();
                    }
                }
            })
        }

        function 加班Demo() {
            $("#加班EmployeeID").val(`${document.cookie.split('id=')[1].split('&')[0]}`),
                $("#加班中文姓名").val(`${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}`),
                $("#加班department").val("資訊部"),
                $("#加班startday").val("2021-04-14T18:00:00"),
                $("#加班endday").val("2021-04-14T21:00:00"),
                $("#加班時數2").val("3"),
                $("#加班ID2").children(":checked").val("1"),
                $("#加班事由說明").val("新增修改功能"),
                $("#加班審核狀態").val("未審核"),
                test給radio值();
        }



        function 加班清空() {
            $("#加班department").val(""),
                $("#加班startday").val(""),
                $("#加班endday").val(""),
                $("#加班時數2").val(""),
                $("#加班事由說明").val(""),
                $("#加班審核狀態").val("")
        }


        function test給radio值() {
            var optobj = document.getElementsByName("加班類別");
            for (i = 0; i < optobj.length; i++) {
                optobj.item(1).checked = true;
            }
        }





        function test清空radio() {
            var optobj = document.getElementsByName("加班類別");
            for (i = 0; i < optobj.length; i++) {
                optobj.item(i).checked = false;
            }
        }


        //======================================= 總表顯示 =======================================

        let 加班getID;



        $(".加班搜尋").click(function () {
            $(".searchvacation1").attr("hidden", false);
        });
        $(".加班搜尋消失").click(function () {
            $(".searchvacation1").attr("hidden", true);
        });

        $(function () {
            getOverTimeList();
        })




        //$('#加班隱藏鍵').click(function () {
        //    $("#Page加班總表隱藏").attr("hidden",true)
        //})





        function search加班() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {

                $.ajax({
                    url: "/DDDDD/SearchAjax加班",
                    data: { 'name': $(".searchbox加班").val() },
                    success: function (overtimelist) {
                        if (overtimelist == 0 || $(".searchbox加班").val() == "") {
                            swal("查無此資料", "請重新輸入", "error");
                            $(".searchbox加班").val('');
                        } else {
                            $("#OverTimeListTbody加班總表").empty();
                            $("#head加班總表").html(
                                `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                            );
                            $(overtimelist).each(function (index, item) {
                                var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                                var testtime1 = new Date(testtime);
                                var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                                var testtime2 = new Date(結束日期);

                                if (testtime1.getHours() < 10) {
                                    h2 = "0" + testtime1.getHours();
                                } else {
                                    h2 = testtime1.getHours();
                                }
                                if (testtime1.getMinutes() < 10) {
                                    var a2 = "0" + testtime1.getMinutes()
                                } else {
                                    a2 = testtime1.getMinutes();
                                }


                                if (testtime2.getHours() < 10) {
                                    h3 = "0" + testtime2.getHours();
                                } else {
                                    h3 = testtime2.getHours();
                                }
                                if (testtime2.getMinutes() < 10) {
                                    var a3 = "0" + testtime2.getMinutes()
                                } else {
                                    a3 = testtime2.getMinutes();
                                }
                                $("#OverTimeListTbody加班總表").append(
                                    `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`

                                );
                                $('.append加班refreshBtn').html(`<a class="btn btn-outline-link button"  onclick="ReFresh加班總表()" ><span>返回</span></a>`);
                            })
                            $(".searchbox加班").val('');
                        }
                    },
                });
                $('#Page加班').attr('hidden', true);
            }
            else {
                $.ajax({
                    url: "/DDDDD/SearchAjax加班",
                    data: { 'name': $(".searchbox加班").val() },
                    success: function (overtimelist) {
                        if (overtimelist == 0 || $(".searchbox加班").val() == "") {
                            swal("查無此資料", "請重新輸入", "error");
                        } else {
                            $("#OverTimeListTbody加班總表").empty();
                            $("#head加班總表").html(
                                `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                            );
                            $(overtimelist).each(function (index, item) {
                                var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                                var testtime1 = new Date(testtime);
                                var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                                var testtime2 = new Date(結束日期);

                                if (testtime1.getHours() < 10) {
                                    h2 = "0" + testtime1.getHours();
                                } else {
                                    h2 = testtime1.getHours();
                                }
                                if (testtime1.getMinutes() < 10) {
                                    var a2 = "0" + testtime1.getMinutes()
                                } else {
                                    a2 = testtime1.getMinutes();
                                }


                                if (testtime2.getHours() < 10) {
                                    h3 = "0" + testtime2.getHours();
                                } else {
                                    h3 = testtime2.getHours();
                                }
                                if (testtime2.getMinutes() < 10) {
                                    var a3 = "0" + testtime2.getMinutes()
                                } else {
                                    a3 = testtime2.getMinutes();
                                }
                                $("#OverTimeListTbody加班總表").append(
                                    `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                        </tr>`
                                );
                                $('.append加班refreshBtn').html(`<a class="btn btn-outline-link button"  onclick="ReFresh加班總表()" ><span>返回</span></a>`);
                            })
                            $(".searchbox加班").val('');
                        }
                    },
                });
            }
            $('#Page加班').attr('hidden', true);
        };


        function getOverTimeList123() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/OverTimeList1",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#OverTimeListTbody加班總表").empty();
                        $("#head加班總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        );
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $("#OverTimeListTbody加班總表").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`

                            );
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/OverTimeList1",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#OverTimeListTbody加班總表").empty();
                        $("#head加班總表").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $("#OverTimeListTbody加班總表").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                        </tr>`
                            );
                        })
                    },
                });
            }
        };



        function getOverTimeList() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/OverTimeListAjax",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#head加班").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        );
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $("#OverTimeListTbody").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`

                            );
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/OverTimeListAjax",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#head加班").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $("#OverTimeListTbody").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                        </tr>`
                            );
                        })
                    },
                });
            }
        };






        function 加班已審核() {
            console.log("操");
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/加班已審核Ajax",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#head已審核").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        );
                        $("#OverTimeListTbody加班").empty();
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $("#OverTimeListTbody加班").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`

                            );
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/加班已審核Ajax",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#head已審核").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        $("#OverTimeListTbody加班").empty();
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $("#OverTimeListTbody加班").append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                        </tr>`
                            );
                        })
                    },
                });
            }
        };





        //======================================= 刪除 =======================================
        function Odelete() {
            if (true) {
                $.ajax({
                    url: "/DDDDD/DeleteOverTimeData",
                    data: { "id": $(event.currentTarget).data("id") },
                    success: function (result) {
                        swal({
                            title: "刪除?",
                            text: "確定要刪除嗎?",
                            icon: 'warning',
                            buttons: true,
                            dangerMode: true,
                        }).then((confirm) => {
                            if (confirm) {
                                swal('刪除', '刪除成功！...', 'success');
                                ReFresh加班();
                                ReFresh加班總表();
                                ReFresh加班未審核總表();
                                ReFresh加班通過總表();
                            } else {
                                swal('刪除', '刪除失敗!...', 'error');
                            }
                        })

                    }
                })
            }
        }
        //======================================= 修改 =======================================
        function Update() {
            console.log(typeof 加班getID);
            console.log($("#加班總表加班ID").val());
            if (true) {
                $.ajax({
                    url: "/DDDDD/OverTimeUpdateAjax",
                    type: "POST",
                    data: {
                        "加班表編號": 加班getID,
                        "EmployeeID": parseInt($("#加班總表EmployeeID").val()),
                        "中文姓名": $("#加班總表中文姓名").val(),
                        "部門": $("#加班總表department").val(),
                        "開始日期": $("#加班總表startday").val(),
                        "結束日期": $("#加班總表endday").val(),
                        "加班時數": $("#加班總表加班時數").val(),
                        "加班ID": $("#加班總表加班ID").children(":checked").val(),
                        "事由說明": $("#加班總表事由說明").val(),
                        "審核狀態": $("#加班approvalStatus").val()
                    },
                    success: function (result) {
                        if (result != 0) {
                            swal("成功", "修改成功", "success");
                            $('#加班彈出').modal('toggle');
                            ReFresh加班();
                            ReFresh加班總表();
                            ReFresh加班未審核總表();
                            ReFresh加班通過總表();
                        }
                    }
                })
            }
        }



        function UpdateGetData() {
            console.log($("#加班總表加班ID").val());
            if ($("#隱藏加班審核").hasClass("active")) {
                $('#加班approvalStatus').attr("disabled", true),
                    $('#加班按鈕消失').attr("hidden", true)
            }
            else {
                $('#加班approvalStatus').attr("disabled", false),
                    $('#加班按鈕消失').attr("hidden", false)
            }
            加班getID = $(event.currentTarget).data("id");
            console.log($(event.currentTarget).data("id"));
            $.ajax({
                url: "/DDDDD/GetUpdateDataOverTime",
                type: "GET",
                data: { "id": $(event.currentTarget).data("id") },
                success: function (getdata) {
                    console.log($("#EmployeeID").val(getdata.EmployeeID));
                    var testtime = parseInt(getdata.開始日期.replace(/\D/igm, ""));
                    var testtime1 = new Date(testtime);
                    var 結束日期 = parseInt(getdata.結束日期.replace(/\D/igm, ""));
                    var testtime2 = new Date(結束日期);
                    if ((testtime1.getMonth() + 1) < 10) //月
                    {
                        var a = "0" + (testtime1.getMonth() + 1);  //why var
                    }
                    else {
                        a = (testtime1.getMonth() + 1);
                    }
                    if ((testtime2.getMonth() + 1) < 10) {
                        var gg2 = "0" + (testtime2.getMonth() + 1);
                    }
                    else {
                        gg2 = (testtime2.getMonth() + 1);
                    }
                    if (testtime1.getDate() < 10) //日
                    {
                        var rr1 = "0" + (testtime1.getDate());
                    }
                    else {
                        rr1 = testtime1.getDate();
                    }
                    if (testtime2.getDate() < 10) {
                        var aa2 = "0" + (testtime2.getDate());
                    }
                    else {
                        aa2 = testtime2.getDate();
                    }
                    if (testtime1.getHours() < 10) //時
                    {
                        var cc1 = "0" + testtime1.getHours();
                    }
                    else {
                        cc1 = testtime1.getHours();
                    }
                    if (testtime2.getHours() < 10) {
                        var dd2 = "0" + testtime2.getHours();
                    }
                    else {
                        dd2 = testtime2.getHours();
                    }
                    if (testtime1.getMinutes() < 10)  //分
                    {
                        var ff1 = "0" + testtime1.getMinutes();
                    }
                    else {
                        ff1 = testtime1.getMinutes();
                    }
                    if (testtime1.getMinutes() < 10) {
                        var mm2 = "0" + testtime1.getMinutes();
                    }
                    else {
                        mm2 = testtime1.getMinutes();
                    }
                    $("#加班表編號").val(getdata.加班表編號);
                    $("#加班總表EmployeeID").val(getdata.EmployeeID);
                    $("#加班總表中文姓名").val(getdata.中文姓名);
                    $("#加班總表department").val(getdata.部門);
                    $("#加班總表startday").val(testtime1.getFullYear() + "-" + a + "-" + rr1
                        + "T" + cc1 + ":" + ff1 + ":00");
                    $("#加班總表endday").val(testtime2.getFullYear() + "-" + gg2 + "-" + aa2
                        + "T" + dd2 + ":" + mm2 + ":00");
                    $("#加班總表加班ID").find(`input[value='${getdata.加班ID}']`).prop("checked", true); //找出input底下有value這個屬性並且值等於加班ID的標籤設定checked屬性
                    $("#加班總表加班時數").val(getdata.加班時數);
                    $("#加班總表事由說明").val(getdata.事由說明);
                    $("#加班approvalStatus").val(getdata.審核狀態)
                }
            })
        }

        //======================================= 刷新 =======================================
        ReFresh加班();
        ReFresh加班總表();
        ReFresh加班未審核總表();
        ReFresh加班通過總表();


        function ReFresh加班() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/OverTimeListAjax",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#OverTimeListTbody").empty();
                        $("#head加班").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let b = " ";
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }

                            b += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`
                            $("#OverTimeListTbody").html(b);
                        })
                    },
                });
            }
            else {
                $.ajax({
                    url: "/DDDDD/OverTimeListAjax",
                    type: "GET",
                    success: function (overtimelist) {
                        $("#OverTimeListTbody").empty();
                        $("#head加班").html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                             </tr>`
                        );
                        let b = " ";
                        $(overtimelist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }

                            b += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                  </tr>`
                            $("#OverTimeListTbody").html(b);
                        })
                    },
                });
            }
        };





        function ReFresh加班總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $('#Page加班').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/OverTimeList1",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (memberlist) {
                        $(".append加班refreshBtn").empty();
                        $("#head加班總表").html(
                            `<tr>
                                                                                                               <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let u = " ";
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);
                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            u += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`
                            $("#OverTimeListTbody加班總表").html(u);
                        })
                    }

                })
                $('#Page加班').attr('hidden', false);
            }
            else {
                $('#Page加班').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/OverTimeList1",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (memberlist) {
                        $(".append加班refreshBtn").empty();
                        $("#head加班總表").html(
                            `<tr>
                                                                                                               <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                </tr>`
                        );
                        let u = " ";
                        $(memberlist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            u += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                  </tr>`
                            $("#OverTimeListTbody加班總表").html(u);
                        })
                    }
                })

            }
            $('#Page加班').attr('hidden', false);
        }









        function ReFresh加班未審核總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $('#Page加班未審核').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/加班未審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (memberlist3) {

                        $(".append加班未審核refreshBtn").empty();
                        $("#head加班").html(
                            `<tr>
                                                                                                               <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let u = " ";
                        $(memberlist3).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            u += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`
                            $("#OverTimeListTbody").html(u);
                        })
                    }

                })

            }
            else {
                $('#Page加班未審核').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/加班未審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (memberlist3) {
                        $(".append加班未審核refreshBtn").empty();
                        $("#head加班").html(
                            `<tr>
                                                                                                               <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let u = " ";
                        $(memberlist3).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }


                            u += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                  </tr>`
                            $("#OverTimeListTbody").html(u);
                        })
                    }
                })

            }
        }








        function ReFresh加班通過總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $('#Page加班通過').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/加班已審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (memberlist3) {

                        $(".append加班通過refreshBtn").empty();
                        $("#head已審核").html(
                            `<tr>
                                                                                                               <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let u = " ";
                        $(memberlist3).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            u += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.加班表編號}" data-target="#加班彈出" onclick="UpdateGetData(),modelshow加班()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="Odelete()" data-id="${item.加班表編號}"><span>刪除</span></a></td></tr>`
                            $("#OverTimeListTbody加班").html(u);
                        })
                    }

                })

            }
            else {
                $('#Page加班通過').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/加班未審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (memberlist3) {
                        $(".append加班通過refreshBtn").empty();
                        $("#head已審核").html(
                            `<tr>
                                                                                                               <th>員工編號</th>
                                                                                                                <th>中文姓名</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>加班時數</th>
                                                                                                                <th>加班類別</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                                </tr>`
                        );
                        let u = " ";
                        $(memberlist3).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }


                            u += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.加班時數}</td>
                                                                                                                    <td>${item.加班類別}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                  </tr>`
                            $("#OverTimeListTbody加班").html(u);
                        })
                    }
                })

            }
        }
        //========================================================= 出差 ===================================================================

        function modelshow出差() {
            $('.tiny#出差彈出').modal('toggle');
        }

        $("#出差EmployeeID").val(`${document.cookie.split('id=')[1].split('&')[0]}`);
        $("#出差中文姓名").val(`${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}`);

        //======================================= 新增 =======================================
        console.log(123);
        function AddBusinessTripAjax() {
            $.ajax({
                url: "/DDDDD/BusinessTripAjax",
                type: "POST",
                data: {
                    "EmployeeID": $("#出差EmployeeID").val(),
                    "中文姓名": $("#出差中文姓名").val(),
                    "部門": $("#出差部門").val(),
                    "出差類型": $("#出差出差類型").val(),
                    "出差地點": $("#出差出差地點").val(),
                    "開始日期": $("#出差開始日期").val(),
                    "結束日期": $("#出差結束日期").val(),
                    "交通需求": $("#出差交通需求").val(),
                    "住宿需求": $("#出差住宿需求").val(),
                    "預支費用": $("#出差預支費用").val(),
                    "備註": $("#出差備註").val(),
                    "審核狀態": $("#出差審核狀態").val(),
                },
                success: function (result) {
                    if (result != null) {
                        setTimeout(function () {
                            //window.location.href = "/DDDDD/BusinessTripList";
                            $("[data-tab='third/b']").not(".tab").click();
                        }, 1000);
                        ReFresh出差();
                        ReFresh出差總表();
                        ReFresh出差未審核總表();
                        ReFresh出差通過總表();
                        swal("成功", "新增成功", "success");
                        出差清空();
                        var 權限陣列 = [];
                        if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "主管" || decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "人事" || decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == "員工") {
                            權限陣列.push('總經理');
                            權限陣列.push('主管');
                        }
                        $.connection.hub.start()
                            .done(function () {
                                bell.server.sendGroup(`${1}`, `${decodeURI(document.cookie.split('Auth=')[1].split('&')[0])}`, `有新的出差申請,請前往審核！`, 權限陣列);   //傳值到hub
                            });
                    }
                }
            })
        }


        function 出差Demo() {
            $("#出差EmployeeID").val(`${document.cookie.split('id=')[1].split('&')[0]}`);
            $("#出差中文姓名").val(`${decodeURI(document.cookie.split('Name=')[1].split('&')[0])}`);
            $("#出差部門").val("資訊部");
            $("#出差出差類型").dropdown('set selected', '國內');
            $("#出差出差地點").val("Taipei");
            $("#出差開始日期").val("2021-04-14T09:00:00");
            $("#出差結束日期").val("2021-04-16T17:00:00");
            $("#出差交通需求").dropdown('set selected', '高鐵票');
            $("#出差預支費用").val("5000");
            $("#出差住宿需求").dropdown('set selected', '國內住宿');
            $("#出差備註").val("協助三代系統上線");
            $("#出差審核狀態").val("未審核")
        };



        function 出差清空() {
            $("#出差部門").val("");
            $("#出差出差類型").dropdown('set selected', '請選擇');
            $("#出差出差地點").val("");
            $("#出差開始日期").val("");
            $("#出差結束日期").val("");
            $("#出差交通需求").dropdown('set selected', '請選擇');
            $("#出差預支費用").val("");
            $("#出差住宿需求").dropdown('set selected', '請選擇');
            $("#出差備註").val("");
            $("#出差審核狀態").val("")
        }

        //======================================= 總表顯示 =======================================

        $(".出差搜尋").click(function () {
            $(".searchvacation").attr("hidden", false);
        });
        $(".出差搜尋消失").click(function () {
            $(".searchvacation").attr("hidden", true);
        });


        GetBusinessTripList();


        function search出差() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/SearchAjax出差",
                    data: { 'name': $(".searchbox出差").val() },
                    success: function (mylist) {
                        if (mylist == 0 || $(".searchbox出差").val() == "") {
                            swal("查無此資料", "請重新輸入", "error");
                            $(".searchbox出差").val('');
                        }
                        else {
                            $("#BusinessTripListTbody出差總表").empty();
                            $('#head出差總表').html(
                                `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                            )
                            $(mylist).each(function (index, item) {
                                var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                                var testtime1 = new Date(testtime);
                                var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                                var testtime2 = new Date(結束日期);

                                if (testtime1.getHours() < 10) {
                                    h2 = "0" + testtime1.getHours();
                                } else {
                                    h2 = testtime1.getHours();
                                }
                                if (testtime1.getMinutes() < 10) {
                                    var a2 = "0" + testtime1.getMinutes()
                                } else {
                                    a2 = testtime1.getMinutes();
                                }


                                if (testtime2.getHours() < 10) {
                                    h3 = "0" + testtime2.getHours();
                                } else {
                                    h3 = testtime2.getHours();
                                }
                                if (testtime2.getMinutes() < 10) {
                                    var a3 = "0" + testtime2.getMinutes()
                                } else {
                                    a3 = testtime2.getMinutes();
                                }
                                $('#BusinessTripListTbody出差總表').append(
                                    `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                                )
                                $('.append出差refreshBtn').html(`<a class="btn btn-outline-link button"  onclick="ReFresh出差總表()" ><span>返回</span></a>`);
                            }
                            )
                            $(".searchbox出差").val('');
                        }




                    }
                })
                $('#Page出差').attr('hidden', true);
            }
            else {
                $.ajax({
                    url: "/DDDDD/SearchAjax出差",
                    data: { 'name': $(".searchbox出差").val() },
                    success: function (mylist) {
                        if (mylist == 0 || $(".searchbox出差").val() == "") {
                            swal("查無此資料", "請重新輸入", "error");
                            $(".searchbox出差").val('');
                        }
                        else {
                            $("#BusinessTripListTbody出差總表").empty();
                            $('#head出差總表').html(
                                `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                            )
                            $(mylist).each(function (index, item) {
                                var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                                var testtime1 = new Date(testtime);
                                var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                                var testtime2 = new Date(結束日期);

                                if (testtime1.getHours() < 10) {
                                    h2 = "0" + testtime1.getHours();
                                } else {
                                    h2 = testtime1.getHours();
                                }
                                if (testtime1.getMinutes() < 10) {
                                    var a2 = "0" + testtime1.getMinutes()
                                } else {
                                    a2 = testtime1.getMinutes();
                                }


                                if (testtime2.getHours() < 10) {
                                    h3 = "0" + testtime2.getHours();
                                } else {
                                    h3 = testtime2.getHours();
                                }
                                if (testtime2.getMinutes() < 10) {
                                    var a3 = "0" + testtime2.getMinutes()
                                } else {
                                    a3 = testtime2.getMinutes();
                                }
                                $('#BusinessTripListTbody出差總表').append(
                                    `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                               </tr>`
                                );
                                $('.append出差refreshBtn').html(`<a class="btn btn-outline-link button" onclick="ReFresh出差總表()"><span>返回</span></a>`);

                            }

                            )
                            $(".searchbox出差").val('');
                        }
                    }
                })
            }
            $('#Page出差').attr('hidden', true);
        }



        function GetBusinessTripList總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/BusinessTripList1",
                    type: "GET",
                    success: function (mylist) {
                        $('#BusinessTripListTbody出差總表').empty();
                        $('#head出差總表').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        )
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $('#BusinessTripListTbody出差總表').append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            )
                        }
                        )

                    }
                })
            }
            else {
                $.ajax({
                    url: "/DDDDD/BusinessTripList1",
                    type: "GET",
                    success: function (mylist) {
                        $('#BusinessTripListTbody出差總表').empty();
                        $('#head出差總表').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        )
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $('#BusinessTripListTbody出差總表').append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            )
                        }
                        )

                    }
                })
            }
        }






        function GetBusinessTripList() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/BusinessTripListAjax",
                    type: "GET",
                    success: function (mylist) {
                        $('#head未審核').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        )
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $('#BusinessTripListTbody').append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            )
                        }
                        )

                    }
                })
            }
            else {
                $.ajax({
                    url: "/DDDDD/BusinessTripListAjax",
                    type: "GET",
                    success: function (mylist) {
                        $('#head未審核').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        )
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $('#BusinessTripListTbody').append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            )
                        }
                        )

                    }
                })
            }
        }








        function 出差已審核() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/出差已審核Ajax",
                    type: "GET",
                    success: function (mylist) {
                        $('#head出差').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        )
                        $("#BusinessTripListTbody出差").empty();
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $('#BusinessTripListTbody出差').append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            )
                        }
                        )

                    }
                })
            }
            else {
                $.ajax({
                    url: "/DDDDD/出差已審核Ajax",
                    type: "GET",
                    success: function (mylist) {
                        $('#head出差').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        )
                        $("#BusinessTripListTbody出差").empty();
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }


                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            $('#BusinessTripListTbody出差').append(
                                `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            )
                        }
                        )

                    }
                })
            }
        }



        //======================================= 刪除 =======================================

        function businessdelete() {
            console.log(123);
            console.log($(event.currentTarget).data("id"));
            $.ajax({
                url: "/DDDDD/DeleteBusinessTrip",
                data: { "id": $(event.currentTarget).data("id") },
                success: function (result) {
                    swal({
                        title: "刪除?",
                        text: "確定要刪除嗎?",
                        icon: 'warning',
                        buttons: true,
                        dangerMode: true,
                    }).then((confirm) => {
                        if (confirm) {
                            swal('刪除', '刪除成功！...', 'success');
                            ReFresh出差();
                            ReFresh出差總表();
                            ReFresh出差未審核總表();
                            ReFresh出差通過總表();
                        } else {
                            swal('刪除', '刪除失敗!...', 'error');
                        }
                    })
                }
            })
        }

        //======================================= 修改 =======================================

        let SwagID;
        function UpdateBusiness() {
            console.log(event.currentTarget);
            $.ajax({
                url: "/DDDDD/UpdateBusinessTripAjax",
                type: "POST",
                data: {
                    "出差表編號": SwagID,
                    "EmployeeID": $("#出差總表EmployeeID").val(),
                    "中文姓名": $("#出差總表中文姓名").val(),
                    "部門": $("#出差總表部門").val(),
                    "出差類型": $("#出差總表出差類型").val(),
                    "出差地點": $("#出差總表出差地點").val(),
                    "開始日期": $("#出差總表開始日期").val(),
                    "結束日期": $("#出差總表結束日期").val(),
                    "交通需求": $("#出差總表交通需求").val(),
                    "住宿需求": $("#出差總表住宿需求").val(),
                    "預支費用": $("#出差總表預支費用").val(),
                    "備註": $("#出差總表備註").val(),
                    "審核狀態": $("#出差approvalStatus").val()
                },
                success: function (result) {
                    if (result != 0) {
                        swal("成功", "修改成功", "success");
                        $('#出差彈出').modal('toggle');
                        ReFresh出差();
                        ReFresh出差總表();
                        ReFresh出差未審核總表();
                        ReFresh出差通過總表();
                    }

                }
            })
        }



        function GetUpdataBusiness() {
            if ($("#隱藏出差審核").hasClass("active")) {
                $('#出差approvalStatus').attr("disabled", true),
                    $('#出差按鈕消失').attr("hidden", true)
            }
            else {
                $('#出差approvalStatus').attr("disabled", false),
                    $('#出差按鈕消失').attr("hidden", false)
            }
            SwagID = $(event.currentTarget).data("id");
            console.log(event.currentTarget);
            console.log(SwagID);
            console.log(132);
            $.ajax({
                url: "/DDDDD/GetUpdateBusinessTripAjax",
                type: "GET",
                data: { "id": $(event.currentTarget).data("id") },
                success: function (getdata) {
                    console.log($("#出差總表EmployeeID").val(getdata.EmployeeID));
                    var 開始日期 = parseInt(getdata.開始日期.replace(/\D/igm, ""));
                    var testtime1 = new Date(開始日期);
                    var 結束日期 = parseInt(getdata.結束日期.replace(/\D/igm, ""));
                    var testtime2 = new Date(結束日期);
                    if ((testtime1.getMonth() + 1) < 10) //月
                    {
                        var a = "0" + (testtime1.getMonth() + 1);  //why var
                    }
                    else {
                        a = (testtime1.getMonth() + 1);
                    }
                    if ((testtime2.getMonth() + 1) < 10) {
                        var gg2 = "0" + (testtime2.getMonth() + 1);
                    }
                    else {
                        gg2 = (testtime2.getMonth() + 1);
                    }
                    if (testtime1.getDate() < 10) //日
                    {
                        var rr1 = "0" + (testtime1.getDate());
                    }
                    else {
                        rr1 = testtime1.getDate();
                    }
                    if (testtime2.getDate() < 10) {
                        var aa2 = "0" + (testtime2.getDate());
                    }
                    else {
                        aa2 = testtime2.getDate();
                    }
                    if (testtime1.getHours() < 10) //時
                    {
                        var cc1 = "0" + testtime1.getHours();
                    }
                    else {
                        cc1 = testtime1.getHours();
                    }
                    if (testtime2.getHours() < 10) {
                        var dd2 = "0" + testtime2.getHours();
                    }
                    else {
                        dd2 = testtime2.getHours();
                    }
                    if (testtime1.getMinutes() < 10)  //分
                    {
                        var ff1 = "0" + testtime1.getMinutes();
                    }
                    else {
                        ff1 = testtime1.getMinutes();
                    }
                    if (testtime1.getMinutes() < 10) {
                        var mm2 = "0" + testtime1.getMinutes();
                    }
                    else {
                        mm2 = testtime1.getMinutes();
                    }
                    $("#出差總表出差表編號").val(getdata.出差表編號);
                    $("#出差總表EmployeeID").val(getdata.EmployeeID);
                    $("#出差總表中文姓名").val(getdata.中文姓名);
                    $("#出差總表部門").val(getdata.部門);
                    $("#出差總表出差類型").val(getdata.出差類型);
                    $("#出差總表出差地點").val(getdata.出差地點);
                    $("#出差總表開始日期").val(testtime1.getFullYear() + "-" + a + "-" + rr1
                        + "T" + cc1 + ":" + ff1 + ":00");
                    $("#出差總表結束日期").val(testtime2.getFullYear() + "-" + gg2 + "-" + aa2
                        + "T" + dd2 + ":" + mm2 + ":00");
                    $("#出差總表交通需求").val(getdata.交通需求);
                    $("#出差總表住宿需求").val(getdata.住宿需求);
                    $("#出差總表預支費用").val(getdata.預支費用);
                    $("#出差總表備註").val(getdata.備註);
                    $("#出差approvalStatus").val(getdata.審核狀態)
                }
            })
        }

        //======================================= 刷新 =======================================
        ReFresh出差();
        ReFresh出差總表();
        ReFresh出差未審核總表();
        ReFresh出差通過總表();

        function ReFresh出差() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                $.ajax({
                    url: "/DDDDD/BusinessTripListAjax",
                    type: "GET",
                    success: function (mylist) {
                        $('#head').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        )
                        let c = " ";
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            c += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody").html(c);
                        }
                        )

                    }
                })
            }
            else {
                $.ajax({
                    url: "/DDDDD/BusinessTripListAjax",
                    type: "GET",
                    success: function (mylist) {
                        $('#head').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        )
                        let c = " ";
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            c += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody").html(c);
                        }
                        )

                    }
                })
            }
        }

        function ReFresh出差總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                console.log("88888");
                $('#Page出差').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/BusinessTripList1",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (mylist) {
                        $('.append出差refreshBtn').empty();
                        $('#head出差總表').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        )
                        let q = " ";
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            q += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody出差總表").html(q);
                        })
                    }

                })
                $('#Page出差').attr('hidden', false);
            }
            else {
                $('#Page出差').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/BusinessTripList1",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (mylist) {
                        $('.append出差refreshBtn').empty();
                        $('#head出差總表').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        )
                        let q = " ";
                        $(mylist).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            q += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody出差總表").html(q);
                        })
                    }
                })

            }
            $('#Page出差').attr('hidden', false);
        }


        function ReFresh出差未審核總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                console.log("88888");
                $('#Page出差未審核').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/出差未審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (mylist1) {
                        $('.append出差未審核refreshBtn').empty();
                        $('#head未審核').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        )
                        let q = " ";
                        $(mylist1).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            q += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody").html(q);
                        })
                    }

                })
            }
            else {
                $('#Page出差未審核').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/出差未審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (mylist1) {
                        $('.append出差未審核refreshBtn').empty();
                        $('#head未審核').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        )
                        let q = " ";
                        $(mylist1).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            q += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody").html(q);
                        })
                    }
                })

            }
        }



        function ReFresh出差通過總表() {
            if (decodeURI(document.cookie.split('Auth=')[1].split('&')[0]) == '主管') {
                console.log("88888");
                $('#Page出差通過').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/出差已審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },

                        })
                    },
                    callback: function (mylist2) {
                        $('.append出差通過refreshBtn').empty();
                        $('#head出差').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                                <th>詳細</th>
                                                                                                                <th>刪除</th>
                                                                                                            </tr>`
                        )
                        let q = " ";
                        $(mylist2).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            q += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                    <td><a class="btn btn-outline-primary button btnDetail" data-toggle="modal" data-id ="${item.出差表編號}" data-target="#出差彈出" onclick="GetUpdataBusiness(),modelshow出差()"><span>詳細</span></a></td>
                                                                                                                    <td><a class="btn btn-outline-danger button"  onclick="businessdelete()" data-id="${item.出差表編號}"><span>刪除</span></a></td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody出差").html(q);
                        })
                    }

                })
            }
            else {
                $('#Page出差通過').pagination({
                    dataSource: function (done) {
                        $.ajax({
                            url: "/DDDDD/出差已審核Ajax",
                            method: "get",
                            success: function (data) {
                                done(data);
                            },
                        })
                    },
                    callback: function (mylist2) {
                        $('.append出差通過refreshBtn').empty();
                        $('#head出差').html(
                            `<tr>
                                                                                                                <th>員工編號</th>
                                                                                                                <th>申請人</th>
                                                                                                                <th>部門</th>
                                                                                                                <th>開始日期</th>
                                                                                                                <th>結束日期</th>
                                                                                                                <th>審核狀態</th>
                                                                                                            </tr>`
                        )
                        let q = " ";
                        $(mylist2).each(function (index, item) {
                            var testtime = parseInt(item.開始日期.replace(/\D/igm, ""));
                            var testtime1 = new Date(testtime);
                            var 結束日期 = parseInt(item.結束日期.replace(/\D/igm, ""));
                            var testtime2 = new Date(結束日期);

                            if (testtime1.getHours() < 10) {
                                h2 = "0" + testtime1.getHours();
                            } else {
                                h2 = testtime1.getHours();
                            }
                            if (testtime1.getMinutes() < 10) {
                                var a2 = "0" + testtime1.getMinutes()
                            } else {
                                a2 = testtime1.getMinutes();
                            }
                            if (testtime2.getHours() < 10) {
                                h3 = "0" + testtime2.getHours();
                            } else {
                                h3 = testtime2.getHours();
                            }
                            if (testtime2.getMinutes() < 10) {
                                var a3 = "0" + testtime2.getMinutes()
                            } else {
                                a3 = testtime2.getMinutes();
                            }
                            q += `<tr>
                                                                                                                    <td>${item.EmployeeID}</td>
                                                                                                                    <td>${item.中文姓名}</td>
                                                                                                                    <td>${item.部門}</td>
                                                                                                                    <td>${testtime1.getFullYear() + "/" + (testtime1.getMonth() + 1) + "/" + testtime1.getDate() + " " + h2 + ":" + a2}</td>
                                                                                                                    <td>${testtime2.getFullYear() + "/" + (testtime2.getMonth() + 1) + "/" + testtime2.getDate() + " " + h3 + ":" + a3}</td>
                                                                                                                    <td>${item.審核狀態}</td>
                                                                                                                </tr>`
                            $("#BusinessTripListTbody出差").html(q);
                        })
                    }
                })

            }
        }

    </script>
}


@*2021/4/6*@